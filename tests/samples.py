import numpy as np
import dask.array as da


CHUNKSIZE = [4, 4]

OVERLAPS = [1, 1]

THRESHOLD = 0.5

BLOCK_INFOS = [
    {0: {"array-location": [(0, 4), (0, 4)]},
     None: {"chunk-location": (0, 0), "num-chunks": (3, 4)}},
    {0: {"array-location": [(0, 4), (4, 8)]},
     None: {"chunk-location": (0, 1), "num-chunks": (3, 4)}},
    {0: {"array-location": [(0, 4), (8, 12)]},
     None: {"chunk-location": (0, 2), "num-chunks": (3, 4)}},
    {0: {"array-location": [(0, 4), (12, 16)]},
     None: {"chunk-location": (0, 3), "num-chunks": (3, 4)}},
    {0: {"array-location": [(4, 8), (0, 4)]},
     None: {"chunk-location": (1, 0), "num-chunks": (3, 4)}},
    {0: {"array-location": [(4, 8), (4, 8)]},
     None: {"chunk-location": (1, 1), "num-chunks": (3, 4)}},
    {0: {"array-location": [(4, 8), (8, 12)]},
     None: {"chunk-location": (1, 2), "num-chunks": (3, 4)}},
    {0: {"array-location": [(4, 8), (12, 16)]},
     None: {"chunk-location": (1, 3), "num-chunks": (3, 4)}},
    {0: {"array-location": [(8, 12), (0, 4)]},
     None: {"chunk-location": (2, 0), "num-chunks": (3, 4)}},
    {0: {"array-location": [(8, 12), (4, 8)]},
     None: {"chunk-location": (2, 1), "num-chunks": (3, 4)}},
    {0: {"array-location": [(8, 12), (8, 12)]},
     None: {"chunk-location": (2, 2), "num-chunks": (3, 4)}},
    {0: {"array-location": [(8, 12), (12, 16)]},
     None: {"chunk-location": (2, 3), "num-chunks": (3, 4)}},
]

INPUT_IMG = da.from_array(np.array([
    [0, 0, 255, 255, 0, 255, 255, 0, 255, 255, 0, 0, 0, 255],
    [0, 0, 255, 255, 0, 255, 255, 0, 255, 255, 0, 0, 0, 0],
    [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 255, 0, 0],
    [0, 0, 255, 255, 0, 255, 255, 0, 255, 255, 0, 255, 0, 0],
    [0, 0, 255, 255, 0, 255, 255, 0, 255, 255, 0, 0, 0, 0],
    [255, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
    [255, 255, 0, 0, 0, 0, 0, 0, 0, 0, 255, 255, 0, 0],
    [0, 0, 0, 0, 0, 0, 0, 255, 255, 0, 255, 255, 0, 0],
    [255, 255, 0, 255, 255, 0, 0, 255, 255, 0, 0, 0, 0, 0],
    [255, 255, 0, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0, 0],
    [0, 0, 0, 0, 0, 0, 0, 255, 255, 0, 255, 255, 0, 0],
    [0, 0, 0, 0, 0, 0, 0, 255, 255, 0, 255, 255, 0, 0]
], dtype=np.uint8), chunks=CHUNKSIZE)

OVERLAPPED_INPUT = da.block([
    [
        np.array([
            [0, 0, 255, 255, 0],
            [0, 0, 255, 255, 0],
            [0, 0, 0, 0, 0],
            [0, 0, 255, 255, 0],
            [0, 0, 255, 255, 0]
        ], dtype=np.uint8),
        np.array([
            [255, 0, 255, 255, 0, 255],
            [255, 0, 255, 255, 0, 255],
            [0, 0, 0, 0, 0, 0],
            [255, 0, 255, 255, 0, 255],
            [255, 0, 255, 255, 0, 255]
        ], dtype=np.uint8),
        np.array([
            [0, 255, 255, 0, 0, 0],
            [0, 255, 255, 0, 0, 0],
            [0, 0, 0, 0, 255, 0],
            [0, 255, 255, 0, 255, 0],
            [0, 255, 255, 0, 0, 0]
        ], dtype=np.uint8),
        np.array([
            [0, 0, 255, 0, 0],
            [0, 0, 0, 0, 0],
            [255, 0, 0, 0, 0],
            [255, 0, 0, 0, 0],
            [0, 0, 0, 0, 0]
        ], dtype=np.uint8),
    ],
    [
        np.array([
            [0, 0, 255, 255, 0],
            [0, 0, 255, 255, 0],
            [255, 0, 0, 0, 0],
            [255, 255, 0, 0, 0],
            [0, 0, 0, 0, 0],
            [255, 255, 0, 255, 255]
        ], dtype=np.uint8),
        np.array([
            [255, 0, 255, 255, 0, 255],
            [255, 0, 255, 255, 0, 255],
            [0, 0, 0, 0, 0, 0],
            [0, 0, 0, 0, 0, 0],
            [0, 0, 0, 0, 255, 255],
            [255, 255, 0, 0, 255, 255]
        ], dtype=np.uint8),
        np.array([
            [0, 255, 255, 0, 255, 0],
            [0, 255, 255, 0, 0, 0],
            [0, 0, 0, 0, 0, 0],
            [0, 0, 0, 255, 255, 0],
            [255, 255, 0, 255, 255, 0],
            [255, 255, 0, 0, 0, 0]
        ], dtype=np.uint8),
        np.array([
            [255, 0, 0, 0, 0],
            [0, 0, 0, 0, 0],
            [0, 0, 0, 0, 0],
            [255, 0, 0, 0, 0],
            [255, 0, 0, 0, 0],
            [0, 0, 0, 0, 0]
        ], dtype=np.uint8),
    ],
    [
        np.array([
            [0, 0, 0, 0, 0],
            [255, 255, 0, 255, 255],
            [255, 255, 0, 255, 255],
            [0, 0, 0, 0, 0],
            [0, 0, 0, 0, 0]
        ], dtype=np.uint8),
        np.array([
            [0, 0, 0, 0, 255, 255],
            [255, 255, 0, 0, 255, 255],
            [255, 255, 0, 0, 0, 0],
            [0, 0, 0, 0, 255, 255],
            [0, 0, 0, 0, 255, 255]
        ], dtype=np.uint8),
        np.array([
            [255, 255, 0, 255, 255, 0],
            [255, 255, 0, 0, 0, 0],
            [0, 0, 0, 0, 0, 0],
            [255, 255, 0, 255, 255, 0],
            [255, 255, 0, 255, 255, 0],
        ], dtype=np.uint8),
        np.array([
            [255, 0, 0, 0, 0],
            [0, 0, 0, 0, 0],
            [0, 0, 0, 0, 0],
            [255, 0, 0, 0, 0],
            [255, 0, 0, 0, 0],
        ], dtype=np.uint8)
    ]
])

SEGMENTATION_RES = da.block([
    [
        np.array([
            [0, 0, 1, 1, 0],
            [0, 0, 1, 1, 0],
            [0, 0, 0, 0, 0],
            [0, 0, 2, 2, 0],
            [0, 0, 2, 2, 0]
        ], dtype=np.int32),
        np.array([
            [1, 0, 2, 2, 0, 3],
            [1, 0, 2, 2, 0, 3],
            [0, 0, 0, 0, 0, 0],
            [4, 0, 5, 5, 0, 6],
            [4, 0, 5, 5, 0, 6]
        ], dtype=np.int32),
        np.array([
            [0, 1, 1, 0, 0, 0],
            [0, 1, 1, 0, 0, 0],
            [0, 0, 0, 0, 2, 0],
            [0, 3, 3, 0, 2, 0],
            [0, 3, 3, 0, 0, 0]
        ], dtype=np.int32),
        np.array([
            [0, 0, 1, 0, 0],
            [0, 0, 0, 0, 0],
            [2, 0, 0, 0, 0],
            [2, 0, 0, 0, 0],
            [0, 0, 0, 0, 0]
        ], dtype=np.int32)
    ],
    [
        np.array([
            [0, 0, 1, 1, 0],
            [0, 0, 1, 1, 0],
            [2, 0, 0, 0, 0],
            [2, 2, 0, 0, 0],
            [0, 0, 0, 0, 0],
            [3, 3, 0, 4, 4]
        ], dtype=np.int32),
        np.array([
            [1, 0, 2, 2, 0, 3],
            [1, 0, 2, 2, 0, 3],
            [0, 0, 0, 0, 0, 0],
            [0, 0, 0, 0, 0, 0],
            [0, 0, 0, 0, 4, 4],
            [5, 5, 0, 0, 4, 4]
        ], dtype=np.int32),
        np.array([
            [0, 1, 1, 0, 2, 0],
            [0, 1, 1, 0, 0, 0],
            [0, 0, 0, 0, 0, 0],
            [0, 0, 0, 3, 3, 0],
            [4, 4, 0, 3, 3, 0],
            [4, 4, 0, 0, 0, 0]
        ], dtype=np.int32),
        np.array([
            [1, 0, 0, 0, 0],
            [0, 0, 0, 0, 0],
            [0, 0, 0, 0, 0],
            [2, 0, 0, 0, 0],
            [2, 0, 0, 0, 0],
            [0, 0, 0, 0, 0]
        ], dtype=np.int32),
    ],
    [
        np.array([
            [0, 0, 0, 0, 0],
            [1, 1, 0, 2, 2],
            [1, 1, 0, 2, 2],
            [0, 0, 0, 0, 0],
            [0, 0, 0, 0, 0]
        ], dtype=np.int32),
        np.array([
            [0, 0, 0, 0, 1, 1],
            [2, 2, 0, 0, 1, 1],
            [2, 2, 0, 0, 0, 0],
            [0, 0, 0, 0, 3, 3],
            [0, 0, 0, 0, 3, 3]
        ], dtype=np.int32),
        np.array([
            [1, 1, 0, 2, 2, 0],
            [1, 1, 0, 0, 0, 0],
            [0, 0, 0, 0, 0, 0],
            [3, 3, 0, 4, 4, 0],
            [3, 3, 0, 4, 4, 0]
        ], dtype=np.int32),
        np.array([
            [1, 0, 0, 0, 0],
            [0, 0, 0, 0, 0],
            [0, 0, 0, 0, 0],
            [2, 0, 0, 0, 0],
            [2, 0, 0, 0, 0],
        ], dtype=np.int32),
    ]
])

REMOVAL_RES = da.block([
    [
        np.array([
            [0, 0, 1, 1, 0],
            [0, 0, 1, 1, 0],
            [0, 0, 0, 0, 0],
            [0, 0, 2, 2, 0],
            [0, 0, 2, 2, 0]
        ], dtype=np.int32),
        np.array([
            [0, 0, 2, 2, 0, 0],
            [0, 0, 2, 2, 0, 0],
            [0, 0, 0, 0, 0, 0],
            [0, 0, 5, 5, 0, 0],
            [0, 0, 5, 5, 0, 0]
        ], dtype=np.int32),
        np.array([
            [0, 1, 1, 0, 0, 0],
            [0, 1, 1, 0, 0, 0],
            [0, 0, 0, 0, 2, 0],
            [0, 3, 3, 0, 2, 0],
            [0, 3, 3, 0, 0, 0]
        ], dtype=np.int32),
        np.array([
            [0, 0, 1, 0, 0],
            [0, 0, 0, 0, 0],
            [0, 0, 0, 0, 0],
            [0, 0, 0, 0, 0],
            [0, 0, 0, 0, 0]
        ], dtype=np.int32),
    ],
    [
        np.array([
            [0, 0, 0, 0, 0],
            [0, 0, 0, 0, 0],
            [2, 0, 0, 0, 0],
            [2, 2, 0, 0, 0],
            [0, 0, 0, 0, 0],
            [0, 0, 0, 0, 0]
        ], dtype=np.int32),
        np.array([
            [0, 0, 0, 0, 0, 0],
            [0, 0, 0, 0, 0, 0],
            [0, 0, 0, 0, 0, 0],
            [0, 0, 0, 0, 0, 0],
            [0, 0, 0, 0, 0, 0],
            [0, 0, 0, 0, 0, 0]
        ], dtype=np.int32),
        np.array([
            [0, 0, 0, 0, 0, 0],
            [0, 0, 0, 0, 0, 0],
            [0, 0, 0, 0, 0, 0],
            [0, 0, 0, 3, 3, 0],
            [0, 0, 0, 3, 3, 0],
            [0, 0, 0, 0, 0, 0]
        ], dtype=np.int32),
        np.array([
            [0, 0, 0, 0, 0],
            [0, 0, 0, 0, 0],
            [0, 0, 0, 0, 0],
            [0, 0, 0, 0, 0],
            [0, 0, 0, 0, 0],
            [0, 0, 0, 0, 0]
        ], dtype=np.int32),
    ],
    [
        np.array([
            [0, 0, 0, 0, 0],
            [1, 1, 0, 2, 2],
            [1, 1, 0, 2, 2],
            [0, 0, 0, 0, 0],
            [0, 0, 0, 0, 0]
        ], dtype=np.int32),
        np.array([
            [0, 0, 0, 0, 0, 0],
            [0, 0, 0, 0, 0, 0],
            [0, 0, 0, 0, 0, 0],
            [0, 0, 0, 0, 0, 0],
            [0, 0, 0, 0, 0, 0]
        ], dtype=np.int32),
        np.array([
            [1, 1, 0, 0, 0, 0],
            [1, 1, 0, 0, 0, 0],
            [0, 0, 0, 0, 0, 0],
            [3, 3, 0, 4, 4, 0],
            [3, 3, 0, 4, 4, 0]
        ], dtype=np.int32),
        np.array([
            [0, 0, 0, 0, 0],
            [0, 0, 0, 0, 0],
            [0, 0, 0, 0, 0],
            [0, 0, 0, 0, 0],
            [0, 0, 0, 0, 0],
        ], dtype=np.int32),
    ]
])

GLOBALLY_SORTED = da.block([
    [
        np.array([
            [0, 0, 1, 1, 0],
            [0, 0, 1, 1, 0],
            [0, 0, 0, 0, 0],
            [0, 0, 2, 2, 0],
            [0, 0, 2, 2, 0]
        ], dtype=np.int32),
        np.array([
            [0, 0, 3, 3, 0, 0],
            [0, 0, 3, 3, 0, 0],
            [0, 0, 0, 0, 0, 0],
            [0, 0, 4, 4, 0, 0],
            [0, 0, 4, 4, 0, 0]
        ], dtype=np.int32),
        np.array([
            [0, 5, 5, 0, 0, 0],
            [0, 5, 5, 0, 0, 0],
            [0, 0, 0, 0, 6, 0],
            [0, 7, 7, 0, 6, 0],
            [0, 7, 7, 0, 0, 0]
        ], dtype=np.int32),
        np.array([
            [0, 0, 8, 0, 0],
            [0, 0, 0, 0, 0],
            [0, 0, 0, 0, 0],
            [0, 0, 0, 0, 0],
            [0, 0, 0, 0, 0]
        ], dtype=np.int32),
    ],
    [
        np.array([
            [0, 0, 0, 0, 0],
            [0, 0, 0, 0, 0],
            [9, 0, 0, 0, 0],
            [9, 9, 0, 0, 0],
            [0, 0, 0, 0, 0],
            [0, 0, 0, 0, 0]
        ], dtype=np.int32),
        np.array([
            [0, 0, 0, 0, 0, 0],
            [0, 0, 0, 0, 0, 0],
            [0, 0, 0, 0, 0, 0],
            [0, 0, 0, 0, 0, 0],
            [0, 0, 0, 0, 0, 0],
            [0, 0, 0, 0, 0, 0]
        ], dtype=np.int32),
        np.array([
            [0, 0, 0, 0, 0, 0],
            [0, 0, 0, 0, 0, 0],
            [0, 0, 0, 0, 0, 0],
            [0, 0, 0, 10, 10, 0],
            [0, 0, 0, 10, 10, 0],
            [0, 0, 0, 0, 0, 0]
        ], dtype=np.int32),
        np.array([
            [0, 0, 0, 0, 0],
            [0, 0, 0, 0, 0],
            [0, 0, 0, 0, 0],
            [0, 0, 0, 0, 0],
            [0, 0, 0, 0, 0],
            [0, 0, 0, 0, 0]
        ], dtype=np.int32),
    ],
    [
        np.array([
            [0, 0, 0, 0, 0],
            [11, 11, 0, 12, 12],
            [11, 11, 0, 12, 12],
            [0, 0, 0, 0, 0],
            [0, 0, 0, 0, 0]
        ], dtype=np.int32),
        np.array([
            [0, 0, 0, 0, 0, 0],
            [0, 0, 0, 0, 0, 0],
            [0, 0, 0, 0, 0, 0],
            [0, 0, 0, 0, 0, 0],
            [0, 0, 0, 0, 0, 0]
        ], dtype=np.int32),
        np.array([
            [13, 13, 0, 0, 0, 0],
            [13, 13, 0, 0, 0, 0],
            [0, 0, 0, 0, 0, 0],
            [14, 14, 0, 15, 15, 0],
            [14, 14, 0, 15, 15, 0]
        ], dtype=np.int32),
        np.array([
            [0, 0, 0, 0, 0],
            [0, 0, 0, 0, 0],
            [0, 0, 0, 0, 0],
            [0, 0, 0, 0, 0],
            [0, 0, 0, 0, 0]
        ], dtype=np.int32),
    ]
])


OVERLAPPED_GLOBALLY_SORTED = da.block([
    [
        np.array([
            [0, 0, 1, 1, 0, 0],
            [0, 0, 1, 1, 0, 0],
            [0, 0, 0, 0, 0, 0],
            [0, 0, 2, 2, 0, 0],
            [0, 0, 2, 2, 0, 0],
            [0, 0, 0, 0, 0, 0]
        ], dtype=np.int32),
        np.array([
            [0, 0, 0, 3, 3, 0, 0, 0],
            [0, 0, 0, 3, 3, 0, 0, 0],
            [0, 0, 0, 0, 0, 0, 0, 0],
            [0, 0, 0, 4, 4, 0, 0, 0],
            [0, 0, 0, 4, 4, 0, 0, 0],
            [0, 0, 0, 0, 0, 0, 0, 0]
        ], dtype=np.int32),
        np.array([
            [0, 0, 5, 5, 0, 0, 0, 0],
            [0, 0, 5, 5, 0, 0, 0, 0],
            [0, 0, 0, 0, 0, 6, 0, 0],
            [0, 0, 7, 7, 0, 6, 0, 0],
            [0, 0, 7, 7, 0, 0, 0, 0],
            [0, 0, 0, 0, 0, 0, 0, 0]
        ], dtype=np.int32),
        np.array([
            [0, 0, 0, 8, 0, 0],
            [0, 0, 0, 0, 0, 0],
            [0, 0, 0, 0, 0, 0],
            [0, 0, 0, 0, 0, 0],
            [0, 0, 0, 0, 0, 0],
            [0, 0, 0, 0, 0, 0]
        ], dtype=np.int32),
    ],
    [
        np.array([
            [0, 0, 2, 2, 0, 0],
            [0, 0, 0, 0, 0, 0],
            [0, 0, 0, 0, 0, 0],
            [9, 0, 0, 0, 0, 0],
            [9, 9, 0, 0, 0, 0],
            [0, 0, 0, 0, 0, 0],
            [0, 0, 0, 0, 0, 0],
            [0, 0, 0, 0, 0, 0]
        ], dtype=np.int32),
        np.array([
            [0, 0, 0, 4, 4, 0, 0, 0],
            [0, 0, 0, 0, 0, 0, 0, 0],
            [0, 0, 0, 0, 0, 0, 0, 0],
            [0, 0, 0, 0, 0, 0, 0, 0],
            [0, 0, 0, 0, 0, 0, 0, 0],
            [0, 0, 0, 0, 0, 0, 0, 0],
            [0, 0, 0, 0, 0, 0, 0, 0],
            [0, 0, 0, 0, 0, 0, 0, 13]
        ], dtype=np.int32),
        np.array([
            [0, 0, 7, 7, 0, 0, 0, 0],
            [0, 0, 0, 0, 0, 0, 0, 0],
            [0, 0, 0, 0, 0, 0, 0, 0],
            [0, 0, 0, 0, 0, 0, 0, 0],
            [0, 0, 0, 0, 10, 10, 0, 0],
            [0, 0, 0, 0, 10, 10, 0, 0],
            [0, 0, 0, 0, 0, 0, 0, 0],
            [0, 13, 13, 0, 0, 0, 0, 0]
        ], dtype=np.int32),
        np.array([
            [0, 0, 0, 0, 0, 0],
            [0, 0, 0, 0, 0, 0],
            [0, 0, 0, 0, 0, 0],
            [0, 0, 0, 0, 0, 0],
            [0, 0, 0, 0, 0, 0],
            [0, 0, 0, 0, 0, 0],
            [0, 0, 0, 0, 0, 0],
            [0, 0, 0, 0, 0, 0]
        ], dtype=np.int32),
    ],
    [
        np.array([
            [0, 0, 0, 0, 0, 0],
            [0, 0, 0, 0, 0, 0],
            [11, 11, 0, 12, 12, 0],
            [11, 11, 0, 12, 12, 0],
            [0, 0, 0, 0, 0, 0],
            [0, 0, 0, 0, 0, 0]
        ], dtype=np.int32),
        np.array([
            [0, 0, 0, 0, 0, 0, 0, 0],
            [0, 0, 0, 0, 0, 0, 0, 13],
            [12, 0, 0, 0, 0, 0, 0, 13],
            [12, 0, 0, 0, 0, 0, 0, 0],
            [0, 0, 0, 0, 0, 0, 0, 14],
            [0, 0, 0, 0, 0, 0, 0, 14]
        ], dtype=np.int32),
        np.array([
            [0, 0, 0, 0, 0, 0, 0, 0],
            [0, 13, 13, 0, 0, 0, 0, 0],
            [0, 13, 13, 0, 0, 0, 0, 0],
            [0, 0, 0, 0, 0, 0, 0, 0],
            [0, 14, 14, 0, 15, 15, 0, 0],
            [0, 14, 14, 0, 15, 15, 0, 0]
        ], dtype=np.int32),
        np.array([
            [0, 0, 0, 0, 0, 0],
            [0, 0, 0, 0, 0, 0],
            [0, 0, 0, 0, 0, 0],
            [0, 0, 0, 0, 0, 0],
            [0, 0, 0, 0, 0, 0],
            [0, 0, 0, 0, 0, 0]
        ], dtype=np.int32),
    ]
])


MERGED_OVERLAPPED_GLOBALLY_SORTED = da.block([
    [
        np.array([
            [0, 0, 1, 1, 0, 0],
            [0, 0, 1, 1, 0, 0],
            [0, 0, 0, 0, 0, 0],
            [0, 0, 2, 2, 0, 0],
            [0, 0, 2, 2, 0, 0],
            [0, 0, 0, 0, 0, 0]
        ], dtype=np.int32),
        np.array([
            [0, 0, 0, 3, 3, 0, 0, 0],
            [0, 0, 0, 3, 3, 0, 0, 0],
            [0, 0, 0, 0, 0, 0, 0, 0],
            [0, 0, 0, 4, 4, 0, 0, 0],
            [0, 0, 0, 4, 4, 0, 0, 0],
            [0, 0, 0, 0, 0, 0, 0, 0]
        ], dtype=np.int32),
        np.array([
            [0, 0, 5, 5, 0, 0, 0, 0],
            [0, 0, 5, 5, 0, 0, 0, 0],
            [0, 0, 0, 0, 0, 6, 0, 0],
            [0, 0, 7, 7, 0, 6, 0, 0],
            [0, 0, 7, 7, 0, 0, 0, 0],
            [0, 0, 0, 0, 0, 0, 0, 0]
        ], dtype=np.int32),
        np.array([
            [0, 0, 0, 8, 0, 0],
            [0, 0, 0, 0, 0, 0],
            [0, 0, 0, 0, 0, 0],
            [0, 0, 0, 0, 0, 0],
            [0, 0, 0, 0, 0, 0],
            [0, 0, 0, 0, 0, 0]
        ], dtype=np.int32),
    ],
    [
        np.array([
            [0, 0, 2, 2, 0, 0],
            [0, 0, 0, 0, 0, 0],
            [0, 0, 2, 2, 0, 0],
            [9, 0, 0, 0, 0, 0],
            [9, 9, 0, 0, 0, 0],
            [0, 0, 0, 0, 0, 0],
            [0, 0, 0, 0, 0, 0],
            [0, 0, 0, 0, 0, 0]
        ], dtype=np.int32),
        np.array([
            [0, 0, 0, 4, 4, 0, 0, 0],
            [0, 0, 0, 0, 0, 0, 0, 0],
            [0, 0, 0, 4, 4, 0, 0, 0],
            [0, 0, 0, 0, 0, 0, 0, 0],
            [0, 0, 0, 0, 0, 0, 0, 0],
            [0, 0, 0, 0, 0, 13, 0, 0],
            [0, 0, 0, 0, 0, 0, 0, 0],
            [0, 0, 0, 0, 0, 0, 0, 13]
        ], dtype=np.int32),
        np.array([
            [0, 0, 7, 7, 0, 0, 0, 0],
            [0, 0, 0, 0, 0, 0, 0, 0],
            [0, 0, 7, 7, 0, 0, 0, 0],
            [0, 0, 0, 0, 0, 0, 0, 0],
            [0, 0, 0, 0, 10, 10, 0, 0],
            [0, 0, 13, 0, 10, 10, 0, 0],
            [0, 0, 0, 0, 0, 0, 0, 0],
            [0, 13, 13, 0, 0, 0, 0, 0]
        ], dtype=np.int32),
        np.array([
            [0, 0, 0, 0, 0, 0],
            [0, 0, 0, 0, 0, 0],
            [0, 0, 0, 0, 0, 0],
            [0, 0, 0, 0, 0, 0],
            [0, 0, 0, 0, 0, 0],
            [0, 0, 0, 0, 0, 0],
            [0, 0, 0, 0, 0, 0],
            [0, 0, 0, 0, 0, 0]
        ], dtype=np.int32),
    ],
    [
        np.array([
            [0, 0, 0, 0, 0, 0],
            [0, 0, 0, 0, 0, 0],
            [11, 11, 0, 12, 12, 0],
            [11, 11, 0, 12, 12, 0],
            [0, 0, 0, 0, 0, 0],
            [0, 0, 0, 0, 0, 0]
        ], dtype=np.int32),
        np.array([
            [0, 0, 0, 0, 0, 0, 0, 0],
            [0, 0, 0, 0, 0, 0, 0, 13],
            [12, 0, 12, 0, 0, 13, 0, 13],
            [12, 0, 12, 0, 0, 0, 0, 0],
            [0, 0, 0, 0, 0, 14, 0, 14],
            [0, 0, 0, 0, 0, 14, 0, 14]
        ], dtype=np.int32),
        np.array([
            [0, 0, 0, 0, 0, 0, 0, 0],
            [0, 13, 13, 0, 0, 0, 0, 0],
            [0, 13, 13, 0, 0, 0, 0, 0],
            [0, 0, 0, 0, 0, 0, 0, 0],
            [0, 14, 14, 0, 15, 15, 0, 0],
            [0, 14, 14, 0, 15, 15, 0, 0]
        ], dtype=np.int32),
        np.array([
            [0, 0, 0, 0, 0, 0],
            [0, 0, 0, 0, 0, 0],
            [0, 0, 0, 0, 0, 0],
            [0, 0, 0, 0, 0, 0],
            [0, 0, 0, 0, 0, 0],
            [0, 0, 0, 0, 0, 0]
        ], dtype=np.int32),
    ]
])


TRIMMED_MERGED_RES = da.block([
    [
        np.array([
            [0, 0, 1, 1],
            [0, 0, 1, 1],
            [0, 0, 0, 0],
            [0, 0, 2, 2]
        ], dtype=np.int32),
        np.array([
            [0, 3, 3, 0],
            [0, 3, 3, 0],
            [0, 0, 0, 0],
            [0, 4, 4, 0]
        ], dtype=np.int32),
        np.array([
            [5, 5, 0, 0],
            [5, 5, 0, 0],
            [0, 0, 0, 6],
            [7, 7, 0, 6]
        ], dtype=np.int32),
        np.array([
            [0, 8, 0, 0],
            [0, 0, 0, 0],
            [0, 0, 0, 0],
            [0, 0, 0, 0]
        ], dtype=np.int32),
    ],
    [
        np.array([
            [0, 0, 2, 2],
            [9, 0, 0, 0],
            [9, 9, 0, 0],
            [0, 0, 0, 0]
        ], dtype=np.int32),
        np.array([
            [0, 4, 4, 0],
            [0, 0, 0, 0],
            [0, 0, 0, 0],
            [0, 0, 0, 13]
        ], dtype=np.int32),
        np.array([
            [7, 7, 0, 0],
            [0, 0, 0, 0],
            [0, 0, 10, 10],
            [13, 0, 10, 10]
        ], dtype=np.int32),
        np.array([
            [0, 0, 0, 0],
            [0, 0, 0, 0],
            [0, 0, 0, 0],
            [0, 0, 0, 0]
        ], dtype=np.int32),
    ],
    [
        np.array([
            [11, 11, 0, 12],
            [11, 11, 0, 12],
            [0, 0, 0, 0],
            [0, 0, 0, 0]
        ], dtype=np.int32),
        np.array([
            [12, 0, 0, 13],
            [12, 0, 0, 0],
            [0, 0, 0, 14],
            [0, 0, 0, 14]
        ], dtype=np.int32),
        np.array([
            [13, 0, 0, 0],
            [0, 0, 0, 0],
            [14, 0, 15, 15],
            [14, 0, 15, 15]
        ], dtype=np.int32),
        np.array([
            [0, 0, 0, 0],
            [0, 0, 0, 0],
            [0, 0, 0, 0],
            [0, 0, 0, 0]
        ], dtype=np.int32),
    ]
])

ANNOTATIONS_OUTPUT = da.block([
    [
        np.array([[{
            "features": [
                {
                    "geometry": {
                        "coordinates": [
                            [[2, 0], [2, 1], [3, 1], [3, 0], [2, 0]]
                        ],
                        "type": "Polygon"
                    },
                    "properties": {
                        "objectType": "cell"
                    },
                    "type": "Feature"
                },
                {
                    "geometry": {
                        "coordinates": [
                            [[2, 3], [2, 4], [3, 4], [3, 3], [2, 3]]
                        ],
                        "type": "Polygon"
                    },
                    "properties": {
                        "objectType": "cell"
                    },
                    "type": "Feature"
                },
            ],
            "type": "FeatureCollection"
        }]], dtype=object),
        np.array([[{
            "features": [
                {
                    "geometry": {
                        "coordinates": [
                            [[5, 0], [5, 1], [6, 1], [6, 0], [5, 0]]
                        ],
                        "type": "Polygon"
                    },
                    "properties": {
                        "objectType": "cell"
                    },
                    "type": "Feature"},
                {
                    "geometry": {
                        "coordinates": [
                            [[5, 3], [5, 4], [6, 4], [6, 3], [5, 3]]
                        ],
                        "type": "Polygon"
                    },
                    "properties": {
                        "objectType": "cell"
                    },
                    "type": "Feature"
                },
            ],
            "type": "FeatureCollection"
        }]], dtype=object),
        np.array([[{
            "features": [
                {
                    "geometry": {
                        "coordinates": [
                            [[8, 0], [8, 1], [9, 1], [9, 0], [8, 0]]
                        ],
                        "type": "Polygon"
                    },
                    "properties": {
                        "objectType": "cell"
                    },
                    "type": "Feature"
                },
                {
                    "geometry": {
                        "coordinates": [
                            [[11, 2], [11, 3], [11, 2]]
                        ],
                        "type": "Polygon"
                    },
                    "properties": {
                        "objectType": "cell"
                    },
                    "type": "Feature"
                },
                {
                    "geometry": {
                        "coordinates": [
                            [[8, 3], [8, 4], [9, 4], [9, 3], [8, 3]]
                        ],
                        "type": "Polygon"
                    },
                    "properties": {
                        "objectType": "cell"
                    },
                    "type": "Feature"
                },
            ],
            "type": "FeatureCollection"
        }]], dtype=object),
        np.array([[0]], dtype=object),
    ],
    [
        np.array([[{
            "features": [
                {
                    "geometry": {
                        "coordinates": [
                            [[0, 5], [0, 6], [1, 6], [0, 5]]
                        ],
                        "type": "Polygon"
                    },
                    "properties": {
                        "objectType": "cell"
                    },
                    "type": "Feature"
                },
            ],
            "type": "FeatureCollection"
        }]], dtype=object),
        np.array([[0]], dtype=object),
        np.array([[{
            "features": [
                {
                    "geometry": {
                        "coordinates": [
                            [[10, 6], [10, 7], [11, 7], [11, 6], [10, 6]]
                        ],
                        "type": "Polygon"
                    },
                    "properties": {
                        "objectType": "cell"
                    },
                    "type": "Feature"
                }
            ],
            "type": "FeatureCollection"
        }]], dtype=object),
        np.array([[0]], dtype=object),
    ],
    [
        np.array([[{
            "features": [
                {
                    "geometry": {
                        "coordinates": [
                            [[0, 8], [0, 9], [1, 9], [1, 8], [0, 8]]
                        ],
                        "type": "Polygon"
                    },
                    "properties": {
                        "objectType": "cell"
                    },
                    "type": "Feature"
                },
                {
                    "geometry": {
                        "coordinates": [
                            [[3, 8], [3, 9], [4, 9], [4, 8], [3, 8]]
                        ],
                        "type": "Polygon"
                    },
                    "properties": {
                        "objectType": "cell"
                    },
                    "type": "Feature"
                },
            ],
            "type": "FeatureCollection"
        }]], dtype=object),
        np.array([[0]], dtype=object),
        np.array([[{
            "features": [
                {
                    "geometry": {
                        "coordinates": [
                            [[7, 7], [7, 8], [8, 8], [8, 7], [7, 7]]
                        ],
                        "type": "Polygon"
                    },
                    "properties": {
                        "objectType": "cell"
                    },
                    "type": "Feature"
                },
                {
                    "geometry": {
                        "coordinates": [
                            [[7, 10], [7, 11], [8, 11], [8, 10], [7, 10]]
                        ],
                        "type": "Polygon"
                    },
                    "properties": {
                        "objectType": "cell"
                    },
                    "type": "Feature"
                },
                {
                    "geometry": {
                        "coordinates": [
                            [[10, 10], [10, 11], [11, 11], [11, 10], [10, 10]]
                        ],
                        "type": "Polygon"
                    },
                    "properties": {
                        "objectType": "cell"
                    },
                    "type": "Feature"
                }
            ],
            "type": "FeatureCollection"
        }]], dtype=object),
        np.array([[0]], dtype=object),
    ]
])
